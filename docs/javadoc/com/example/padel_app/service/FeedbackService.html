<!DOCTYPE HTML>
<html lang>
<head>
<!-- Generated by javadoc (21) on Fri Nov 28 14:55:58 GMT+01:00 2025 -->
<title>FeedbackService (padel-app 0.0.1-SNAPSHOT API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2025-11-28">
<meta name="description" content="declaration: package: com.example.padel_app.service, class: FeedbackService">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../script-dir/jquery-ui.min.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-3.7.1.min.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var pathtoroot = "../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/FeedbackService.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html#class">Help</a></li>
</ul>
<ul class="sub-nav-list-small">
<li>
<p>Summary:</p>
<ul>
<li>Nested</li>
<li>Field</li>
<li><a href="#constructor-summary">Constr</a></li>
<li><a href="#method-summary">Method</a></li>
</ul>
</li>
<li>
<p>Detail:</p>
<ul>
<li>Field</li>
<li><a href="#constructor-detail">Constr</a></li>
<li><a href="#method-detail">Method</a></li>
</ul>
</li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list">
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor-summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor-detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><a href="../../../../search.html">SEARCH</a>
<input type="text" id="search-input" disabled placeholder="Search">
<input type="reset" id="reset-button" disabled value="reset">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">com.example.padel_app.service</a></div>
<h1 title="Class FeedbackService" class="title">Class FeedbackService</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">com.example.padel_app.service.FeedbackService</div>
</div>
<section class="class-description" id="class-description">
<hr>
<div class="type-signature"><span class="annotations">@Service
@Transactional(readOnly=true)
</span><span class="modifiers">public class </span><span class="element-name type-name-label">FeedbackService</span>
<span class="extends-implements">extends <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></span></div>
<div class="block">FeedbackService - Service per gestione feedback tra giocatori
 
 RESPONSABILITÀ BUSINESS LOGIC:
 Questo service gestisce il sistema di valutazione tra giocatori dopo le partite.
 Ogni giocatore può lasciare feedback agli altri partecipanti suggerendo il loro
 livello tecnico percepito durante la partita.
 
 FLUSSO PRINCIPALE:
 1. Partita completata → giocatori possono lasciare feedback
 2. Ogni giocatore valuta gli altri (1 feedback per coppia giocatore-match)
 3. Sistema calcola livello percepito in base a feedback ricevuti
 4. Livello percepito aiuta a creare partite bilanciate
 
 CONCETTI SPRING DIMOSTRATI:
 
 1. @Service - Componente business logic
    - Marca classe come service layer Spring
    - Auto-scansionato da component scan
    - Iniettabile in controller e altri service
 
 2. @Transactional - Gestione transazioni database
    - readOnly=true (default classe): ottimizzazione per query read-only
    - @Transactional su metodi write: garantisce ACID properties
    - Se errore → rollback automatico (nessun dato parziale salvato)
 
 3. @RequiredArgsConstructor (Lombok)
    - Genera costruttore con parametri per campi final
    - Spring usa costruttore per dependency injection
    - Equivalente a: public FeedbackService(FeedbackRepository repo, UserRepository userRepo) {...}
 
 4. @Slf4j (Lombok)
    - Genera logger automaticamente: log.info(), log.warn(), log.debug()
    - Utile per debugging e monitoraggio applicazione
 
 ALGORITMO CALCOLO PERCEIVED LEVEL:
 Il livello percepito è calcolato come media matematica dei feedback ricevuti.
 
 Conversione enum → numero tramite ordinal():
 - PRINCIPIANTE (ordinal = 0) → valore 0
 - INTERMEDIO (ordinal = 1) → valore 1
 - AVANZATO (ordinal = 2) → valore 2
 - PROFESSIONISTA (ordinal = 3) → valore 3
 
 Nota: la documentazione parla di valori 1-4, ma il codice usa ordinal() che parte da 0.
 Questo funziona comunque perché manteniamo la stessa scala per conversione e riconversione.
 
 Esempio calcolo:
 - Giocatore riceve feedback: [INTERMEDIO, AVANZATO, INTERMEDIO]
 - Conversione ordinal: [1, 2, 1]
 - Media: (1 + 2 + 1) / 3 = 1.33
 - Arrotondamento: Math.round(1.33) = 1
 - Level.values()[1] = INTERMEDIO
 
 Altro esempio:
 - Feedback ricevuti: [AVANZATO, PROFESSIONISTA, AVANZATO]
 - Ordinal: [2, 3, 2]
 - Media: (2 + 3 + 2) / 3 = 2.33
 - Arrotondamento: Math.round(2.33) = 2
 - Risultato: AVANZATO
 
 Questo algoritmo permette di:
 - Valutazione oggettiva basata su opinioni multiple
 - Aggiustamento automatico livello con più partite
 - Rilevare discrepanze tra declaredLevel (auto-dichiarato) e perceivedLevel (da altri)
 
 VALIDAZIONE UNICITÀ:
 Un giocatore può lasciare UN SOLO feedback per ogni coppia (targetUser, match).
 Previene duplicati e manipolazione del sistema di rating.</div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor-summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E()" class="member-name-link">FeedbackService</a>()</code></div>
<div class="col-last even-row-color">&nbsp;</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel" aria-labelledby="method-summary-table-tab0">
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="../model/Feedback.html" title="class in com.example.padel_app.model">Feedback</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#createFeedback(com.example.padel_app.model.User,com.example.padel_app.model.User,com.example.padel_app.model.Match,com.example.padel_app.model.enums.Level,java.lang.String)" class="member-name-link">createFeedback</a><wbr>(<a href="../model/User.html" title="class in com.example.padel_app.model">User</a>&nbsp;author,
 <a href="../model/User.html" title="class in com.example.padel_app.model">User</a>&nbsp;targetUser,
 <a href="../model/Match.html" title="class in com.example.padel_app.model">Match</a>&nbsp;match,
 <a href="../model/enums/Level.html" title="enum class in com.example.padel_app.model.enums">Level</a>&nbsp;suggestedLevel,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;comment)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Crea un nuovo feedback dopo una partita
 
 BUSINESS LOGIC:
 Permette a un giocatore (author) di valutare un altro giocatore (targetUser)
 suggerendo il livello tecnico osservato durante una specifica partita (match).</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Optional.html" title="class or interface in java.util" class="external-link">Optional</a><wbr>&lt;<a href="../model/Feedback.html" title="class in com.example.padel_app.model">Feedback</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getFeedback(com.example.padel_app.model.User,com.example.padel_app.model.User,com.example.padel_app.model.Match)" class="member-name-link">getFeedback</a><wbr>(<a href="../model/User.html" title="class in com.example.padel_app.model">User</a>&nbsp;author,
 <a href="../model/User.html" title="class in com.example.padel_app.model">User</a>&nbsp;targetUser,
 <a href="../model/Match.html" title="class in com.example.padel_app.model">Match</a>&nbsp;match)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Cerca feedback specifico tra author, targetUser e match
 
 BUSINESS LOGIC:
 Prima di mostrare form "Lascia feedback", verifica se già esiste.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a><wbr>&lt;<a href="../model/Feedback.html" title="class in com.example.padel_app.model">Feedback</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getFeedbacksByAuthor(com.example.padel_app.model.User)" class="member-name-link">getFeedbacksByAuthor</a><wbr>(<a href="../model/User.html" title="class in com.example.padel_app.model">User</a>&nbsp;user)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Recupera tutti i feedback scritti da un utente
 
 BUSINESS LOGIC:
 Usato per mostrare "Feedback che ho lasciato" nel profilo utente.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a><wbr>&lt;<a href="../model/Feedback.html" title="class in com.example.padel_app.model">Feedback</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getFeedbacksByAuthorAndMatch(com.example.padel_app.model.User,com.example.padel_app.model.Match)" class="member-name-link">getFeedbacksByAuthorAndMatch</a><wbr>(<a href="../model/User.html" title="class in com.example.padel_app.model">User</a>&nbsp;author,
 <a href="../model/Match.html" title="class in com.example.padel_app.model">Match</a>&nbsp;match)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Recupera feedback scritti da un autore in una specifica partita
 
 BUSINESS LOGIC:
 Dopo una partita, mostra quali feedback un giocatore ha già lasciato.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a><wbr>&lt;<a href="../model/Feedback.html" title="class in com.example.padel_app.model">Feedback</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getFeedbacksByMatch(com.example.padel_app.model.Match)" class="member-name-link">getFeedbacksByMatch</a><wbr>(<a href="../model/Match.html" title="class in com.example.padel_app.model">Match</a>&nbsp;match)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Recupera tutti i feedback relativi a una partita
 
 BUSINESS LOGIC:
 Statistiche partita: quanti feedback sono stati scambiati.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a><wbr>&lt;<a href="../model/Feedback.html" title="class in com.example.padel_app.model">Feedback</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getFeedbacksByTargetUser(com.example.padel_app.model.User)" class="member-name-link">getFeedbacksByTargetUser</a><wbr>(<a href="../model/User.html" title="class in com.example.padel_app.model">User</a>&nbsp;user)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Recupera tutti i feedback ricevuti da un utente
 
 BUSINESS LOGIC:
 Usato per mostrare pagina profilo utente, sezione "Cosa dicono di me".</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#updatePerceivedLevel(java.lang.Long)" class="member-name-link">updatePerceivedLevel</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&nbsp;userId)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Aggiorna il livello percepito di un utente basato sui feedback ricevuti
 
 ALGORITMO CALCOLO PERCEIVED LEVEL:
 
 1.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor-detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;()">
<h3>FeedbackService</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">FeedbackService</span>()</div>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="createFeedback(com.example.padel_app.model.User,com.example.padel_app.model.User,com.example.padel_app.model.Match,com.example.padel_app.model.enums.Level,java.lang.String)">
<h3>createFeedback</h3>
<div class="member-signature"><span class="annotations">@Transactional
</span><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="../model/Feedback.html" title="class in com.example.padel_app.model">Feedback</a></span>&nbsp;<span class="element-name">createFeedback</span><wbr><span class="parameters">(<a href="../model/User.html" title="class in com.example.padel_app.model">User</a>&nbsp;author,
 <a href="../model/User.html" title="class in com.example.padel_app.model">User</a>&nbsp;targetUser,
 <a href="../model/Match.html" title="class in com.example.padel_app.model">Match</a>&nbsp;match,
 <a href="../model/enums/Level.html" title="enum class in com.example.padel_app.model.enums">Level</a>&nbsp;suggestedLevel,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;comment)</span></div>
<div class="block">Crea un nuovo feedback dopo una partita
 
 BUSINESS LOGIC:
 Permette a un giocatore (author) di valutare un altro giocatore (targetUser)
 suggerendo il livello tecnico osservato durante una specifica partita (match).
 
 VALIDAZIONE UNICITÀ:
 Prima di creare il feedback, verifica che non esista già un feedback
 con la stessa tripla (author, targetUser, match).
 
 Esempio scenario:
 - Match #5: Alice, Bob, Charlie, Diana giocano insieme
 - Alice può lasciare feedback a: Bob, Charlie, Diana (max 3 feedback)
 - Alice NON può lasciare 2 feedback a Bob per lo stesso match
 
 TRANSACTIONAL:</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>author</code> - Utente che scrive il feedback (chi valuta)</dd>
<dd><code>targetUser</code> - Utente che riceve il feedback (chi viene valutato)</dd>
<dd><code>match</code> - Partita in cui è avvenuta l'interazione</dd>
<dd><code>suggestedLevel</code> - Livello tecnico suggerito (osservazione durante partita)</dd>
<dd><code>comment</code> - Commento testuale opzionale (es: "Ottimo diritto, serve da migliorare")</dd>
<dt>Returns:</dt>
<dd>Feedback salvato con ID generato</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/RuntimeException.html" title="class or interface in java.lang" class="external-link">RuntimeException</a></code> - se feedback già esistente per questa tripla
 
 Esempio uso nel controller:
 <pre>
 User alice = userContext.getCurrentUser();
 User bob = userService.getUserById(bobId).orElseThrow();
 Match match = matchService.getMatchById(matchId).orElseThrow();
 
 Feedback feedback = feedbackService.createFeedback(
     alice, bob, match, 
     Level.INTERMEDIO, 
     "Buon giocatore, movimento in campo da migliorare"
 );
 </pre></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="updatePerceivedLevel(java.lang.Long)">
<h3>updatePerceivedLevel</h3>
<div class="member-signature"><span class="annotations">@Transactional
</span><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">updatePerceivedLevel</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&nbsp;userId)</span></div>
<div class="block">Aggiorna il livello percepito di un utente basato sui feedback ricevuti
 
 ALGORITMO CALCOLO PERCEIVED LEVEL:
 
 1. Recupera tutti i feedback ricevuti dall'utente
 2. Converte ogni suggestedLevel in numero usando ordinal():
    - PRINCIPIANTE (ordinal=0) → valore 0
    - INTERMEDIO (ordinal=1) → valore 1
    - AVANZATO (ordinal=2) → valore 2
    - PROFESSIONISTA (ordinal=3) → valore 3
 3. Calcola media aritmetica
 4. Arrotonda al livello più vicino con Math.round()
 5. Converte indice → Level usando Level.values()[index]
 
 Esempio concreto:
 - Bob ha ricevuto 5 feedback: [INTERMEDIO, AVANZATO, INTERMEDIO, AVANZATO, PROFESSIONISTA]
 - Conversione ordinal: [1, 2, 1, 2, 3]
 - Media: (1+2+1+2+3)/5 = 1.8
 - Arrotondamento: Math.round(1.8) = 2
 - Level.values()[2] = AVANZATO
 - Bob.perceivedLevel = AVANZATO
 
 CASI PARTICOLARI:
 - Nessun feedback: perceived level rimane invariato (non viene aggiornato)
 - 1 solo feedback: perceived level = suggestedLevel di quel feedback
 - Utente non trovato: log warning, nessuna modifica
 
 TRANSACTIONAL:
 Metodo write che modifica User.perceivedLevel.
 In caso di errore durante salvataggio → rollback automatico.
 
 INVOCAZIONE AUTOMATICA:
 Chiamato automaticamente da createFeedback() dopo ogni nuovo feedback.
 Garantisce che perceivedLevel sia sempre sincronizzato con feedback ricevuti.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>userId</code> - ID dell'utente di cui aggiornare il perceived level
 
 Esempio comportamento completo:
 <pre>
 // Stato iniziale Bob
 bob.declaredLevel = INTERMEDIO (auto-dichiarato)
 bob.perceivedLevel = null (nessun feedback ancora)
 
 // Alice lascia feedback: AVANZATO
 feedbackService.createFeedback(alice, bob, match1, AVANZATO, "Molto forte");
 // → updatePerceivedLevel chiamato automaticamente
 // → bob.perceivedLevel = AVANZATO (1 solo feedback)
 
 // Charlie lascia feedback: INTERMEDIO
 feedbackService.createFeedback(charlie, bob, match2, INTERMEDIO, "Buon livello");
 // → bob.perceivedLevel = INTERMEDIO (media di AVANZATO e INTERMEDIO)
 
 // Sistema ora sa: Bob si dichiara INTERMEDIO, altri lo vedono tra INTERMEDIO-AVANZATO
 </pre></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getFeedbacksByTargetUser(com.example.padel_app.model.User)">
<h3>getFeedbacksByTargetUser</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="../model/Feedback.html" title="class in com.example.padel_app.model">Feedback</a>&gt;</span>&nbsp;<span class="element-name">getFeedbacksByTargetUser</span><wbr><span class="parameters">(<a href="../model/User.html" title="class in com.example.padel_app.model">User</a>&nbsp;user)</span></div>
<div class="block">Recupera tutti i feedback ricevuti da un utente
 
 BUSINESS LOGIC:
 Usato per mostrare pagina profilo utente, sezione "Cosa dicono di me".
 
 Esempio:
 <pre>
 List<Feedback> bobReviews = feedbackService.getFeedbacksByTargetUser(bob);
 // Mostra tutti i commenti e valutazioni che Bob ha ricevuto
 </pre></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>user</code> - Utente di cui recuperare i feedback ricevuti</dd>
<dt>Returns:</dt>
<dd>Lista feedback ricevuti (può essere vuota se nessuno ha ancora valutato)</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getFeedbacksByAuthor(com.example.padel_app.model.User)">
<h3>getFeedbacksByAuthor</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="../model/Feedback.html" title="class in com.example.padel_app.model">Feedback</a>&gt;</span>&nbsp;<span class="element-name">getFeedbacksByAuthor</span><wbr><span class="parameters">(<a href="../model/User.html" title="class in com.example.padel_app.model">User</a>&nbsp;user)</span></div>
<div class="block">Recupera tutti i feedback scritti da un utente
 
 BUSINESS LOGIC:
 Usato per mostrare "Feedback che ho lasciato" nel profilo utente.
 
 Esempio:
 <pre>
 List<Feedback> aliceFeedbacks = feedbackService.getFeedbacksByAuthor(alice);
 // Mostra tutti i feedback che Alice ha scritto per altri giocatori
 </pre></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>user</code> - Utente autore dei feedback</dd>
<dt>Returns:</dt>
<dd>Lista feedback scritti dall'utente</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getFeedbacksByAuthorAndMatch(com.example.padel_app.model.User,com.example.padel_app.model.Match)">
<h3>getFeedbacksByAuthorAndMatch</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="../model/Feedback.html" title="class in com.example.padel_app.model">Feedback</a>&gt;</span>&nbsp;<span class="element-name">getFeedbacksByAuthorAndMatch</span><wbr><span class="parameters">(<a href="../model/User.html" title="class in com.example.padel_app.model">User</a>&nbsp;author,
 <a href="../model/Match.html" title="class in com.example.padel_app.model">Match</a>&nbsp;match)</span></div>
<div class="block">Recupera feedback scritti da un autore in una specifica partita
 
 BUSINESS LOGIC:
 Dopo una partita, mostra quali feedback un giocatore ha già lasciato.
 Utile per sapere a chi manca ancora lasciare feedback.
 
 Esempio scenario:
 - Match #10: Alice, Bob, Charlie, Diana
 - Alice ha già lasciato feedback a Bob e Charlie
 - getFeedbacksByAuthorAndMatch(alice, match10) → [feedback_bob, feedback_charlie]
 - Sistema sa che Alice deve ancora valutare Diana</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>author</code> - Autore dei feedback</dd>
<dd><code>match</code> - Partita specifica</dd>
<dt>Returns:</dt>
<dd>Lista feedback lasciati dall'autore in quella partita</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getFeedbacksByMatch(com.example.padel_app.model.Match)">
<h3>getFeedbacksByMatch</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="../model/Feedback.html" title="class in com.example.padel_app.model">Feedback</a>&gt;</span>&nbsp;<span class="element-name">getFeedbacksByMatch</span><wbr><span class="parameters">(<a href="../model/Match.html" title="class in com.example.padel_app.model">Match</a>&nbsp;match)</span></div>
<div class="block">Recupera tutti i feedback relativi a una partita
 
 BUSINESS LOGIC:
 Statistiche partita: quanti feedback sono stati scambiati.
 Utile per metriche e analytics.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>match</code> - Partita di interesse</dd>
<dt>Returns:</dt>
<dd>Lista tutti i feedback relativi a quella partita</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getFeedback(com.example.padel_app.model.User,com.example.padel_app.model.User,com.example.padel_app.model.Match)">
<h3>getFeedback</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Optional.html" title="class or interface in java.util" class="external-link">Optional</a>&lt;<a href="../model/Feedback.html" title="class in com.example.padel_app.model">Feedback</a>&gt;</span>&nbsp;<span class="element-name">getFeedback</span><wbr><span class="parameters">(<a href="../model/User.html" title="class in com.example.padel_app.model">User</a>&nbsp;author,
 <a href="../model/User.html" title="class in com.example.padel_app.model">User</a>&nbsp;targetUser,
 <a href="../model/Match.html" title="class in com.example.padel_app.model">Match</a>&nbsp;match)</span></div>
<div class="block">Cerca feedback specifico tra author, targetUser e match
 
 BUSINESS LOGIC:
 Prima di mostrare form "Lascia feedback", verifica se già esiste.
 Se esiste → mostra "Hai già lasciato feedback"
 Se non esiste → mostra form compilabile
 
 Esempio uso nel controller:
 <pre>
 Optional<Feedback> existing = feedbackService.getFeedback(alice, bob, match5);
 if (existing.isPresent()) {
     model.addAttribute("message", "Hai già lasciato feedback a questo giocatore");
     model.addAttribute("feedback", existing.get());
 } else {
     model.addAttribute("showForm", true);
 }
 </pre></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>author</code> - Autore feedback</dd>
<dd><code>targetUser</code> - Destinatario feedback</dd>
<dd><code>match</code> - Partita specifica</dd>
<dt>Returns:</dt>
<dd>Optional contenente feedback se esiste, empty altrimenti</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small>Copyright &#169; 2025. All rights reserved.</small></p>
</footer>
</div>
</div>
</body>
</html>
